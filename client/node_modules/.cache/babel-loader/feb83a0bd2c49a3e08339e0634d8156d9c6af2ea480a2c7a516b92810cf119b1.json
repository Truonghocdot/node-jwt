{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useContext, useState } from \"react\";\nimport ReactQill from \"react-quill\";\nimport \"react-quill/dist/quill.snow.css\";\nimport { AuthContext } from \"../context/authContext.js\";\nimport Header from \"../components/Header.js\";\nimport Footer from \"../components/Footer.js\";\nimport axios from \"axios\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport moment from \"moment\";\nconst Write = () => {\n  _s();\n  const {\n    currentUser\n  } = useContext(AuthContext);\n  const navigate = useNavigate();\n  const state = useLocation().state;\n  const [value, setValue] = useState((state === null || state === void 0 ? void 0 : state.description) || \"\");\n  const [title, setTitle] = useState((state === null || state === void 0 ? void 0 : state.title) || \"\");\n  const [file, setFile] = useState(null);\n  const [cat, setCat] = useState((state === null || state === void 0 ? void 0 : state.cat) || \"\");\n  const access_token = document.cookie.slice(13);\n  const upload = async () => {\n    try {\n      const formData = new FormData();\n      formData.append(\"file\", file);\n      const res = await axios.post(\"http://localhost:8800/api/upload\", formData);\n      return res.data;\n    } catch (err) {\n      console.log(err);\n    }\n  };\n  const handleClick = async e => {\n    e.preventDefault();\n    const imgUrl = await upload();\n    try {\n      let res = \"\";\n      console.log(123);\n      if (state) {\n        res = await axios.patch(`http://localhost:8800/api/post/${state.id}`, {\n          title,\n          description: value,\n          cat,\n          img: file ? imgUrl : \"\",\n          access_token\n        });\n      } else {\n        res = await axios.post(`http://localhost:8800/api/post`, {\n          title,\n          description: value,\n          cat,\n          img: file ? imgUrl : \"\",\n          date: moment(Date.now()).format(\"YYY--MM-DD HH:mm:ss\"),\n          access_token\n        });\n      }\n      console.log(res);\n    } catch (err) {\n      console.log(err);\n    }\n    navigate(\"/\");\n  };\n  console.log(currentUser);\n};\n_s(Write, \"QrOP/k9DJMwDJgzMCluKJDWG6CE=\", false, function () {\n  return [useNavigate, useLocation];\n});\n_c = Write;\nexport default Write;\nvar _c;\n$RefreshReg$(_c, \"Write\");","map":{"version":3,"names":["React","useContext","useState","ReactQill","AuthContext","Header","Footer","axios","useLocation","useNavigate","moment","Write","_s","currentUser","navigate","state","value","setValue","description","title","setTitle","file","setFile","cat","setCat","access_token","document","cookie","slice","upload","formData","FormData","append","res","post","data","err","console","log","handleClick","e","preventDefault","imgUrl","patch","id","img","date","Date","now","format","_c","$RefreshReg$"],"sources":["D:/full_node/client/src/pages/Write.js"],"sourcesContent":["import React, { useContext, useState } from \"react\";\r\nimport ReactQill from \"react-quill\";\r\nimport \"react-quill/dist/quill.snow.css\";\r\nimport { AuthContext } from \"../context/authContext.js\";\r\nimport Header from \"../components/Header.js\";\r\nimport Footer from \"../components/Footer.js\";\r\nimport axios from \"axios\";\r\nimport { useLocation, useNavigate } from \"react-router-dom\";\r\nimport moment from \"moment\";\r\n\r\nconst Write = () => {\r\n  const { currentUser } = useContext(AuthContext);\r\n\r\n  const navigate = useNavigate();\r\n  const state = useLocation().state;\r\n  const [value, setValue] = useState(state?.description || \"\");\r\n  const [title, setTitle] = useState(state?.title || \"\");\r\n  const [file, setFile] = useState(null);\r\n  const [cat, setCat] = useState(state?.cat || \"\");\r\n  const access_token = document.cookie.slice(13);\r\n  const upload = async () => {\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append(\"file\", file);\r\n      const res = await axios.post(\r\n        \"http://localhost:8800/api/upload\",\r\n        formData\r\n      );\r\n      return res.data;\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n  const handleClick = async (e) => {\r\n    e.preventDefault();\r\n    const imgUrl = await upload();\r\n    try {\r\n      let res = \"\";\r\n      console.log(123);\r\n      if (state) {\r\n        res = await axios.patch(`http://localhost:8800/api/post/${state.id}`, {\r\n          title,\r\n          description: value,\r\n          cat,\r\n          img: file ? imgUrl : \"\",\r\n          access_token,\r\n        });\r\n      } else {\r\n        res = await axios.post(`http://localhost:8800/api/post`, {\r\n          title,\r\n          description: value,\r\n          cat,\r\n          img: file ? imgUrl : \"\",\r\n          date: moment(Date.now()).format(\"YYY--MM-DD HH:mm:ss\"),\r\n          access_token,\r\n        });\r\n      }\r\n      console.log(res);\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n    navigate(\"/\");\r\n  };\r\n  console.log(currentUser);\r\n};\r\nexport default Write;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}